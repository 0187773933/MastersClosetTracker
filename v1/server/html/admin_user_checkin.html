<html>
	<head>
		<title>User Check In</title>
		<link rel="icon" href="">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
	</head>
	<body>
		<div class="container">
			<div class="row">
				<div class="col-sm">
					<center><h1>Check In Users Here</h1></center>
				</div>
			</div>
			<br><br>
			<div class="row">
				<div class="col-sm">
					<div class="form-group d-flex">
						<input id="check-in-input" type="text" class="form-control flex-grow-1">
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm">
					<div class="alert alert-success" id="checked-in-alert-true">
						User Checked In !!!
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-sm">
					<div class="alert alert-danger" id="checked-in-alert-false">
						<center>User Checked In Too Recently !!! &nbsp;<a class="btn btn-warning" target="_blank" href="/admin/user/checkin/override">Override</a></center>
					</div>
				</div>
			</div>
		</div>
		<script>
			// 2b59de91-a39e-4808-9666-a423a1aa94dd
			const uuid_v4_regex = /^[0-9A-F]{8}-[0-9A-F]{4}-[4][0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i
			function is_uuid( str ) { return uuid_v4_regex.test( str ); }
			function on_check_in_input_change( event ) {
				const valid_uuid = is_uuid( event.target.value );
				if ( valid_uuid === false ) { return; }
				// now we need to query the backend to validate the user has not checked-in too recently
				// let valid_checked_in = queryBackEndForCheckInStatus( event.target.value );
				let valid_check_in = true;
				console.log( `${event.target.value} === ${valid_uuid} === Checked In === ${valid_check_in}` );
				switch ( valid_check_in ) {
					case true:
						$( "#checked-in-alert-true" ).slideDown();
						$( "#checked-in-alert-false" ).slideUp();
						setTimeout( function() {
							$( "#checked-in-alert-true" ).slideUp();
							$( "#check-in-input" ).val( "" );
						} , 3000 );
						break;
					case false:
						$( "#checked-in-alert-true" ).slideUp();
						$( "#checked-in-alert-false" ).slideDown();
						break;
				}
			}
			function init() {
				// $( "#check-in-input" ).focus();
				window.check_in_input = document.getElementById( "check-in-input" );
				$( "#checked-in-alert-true" ).slideUp();
				$( "#checked-in-alert-false" ).slideUp();
				window.check_in_input.focus();
				check_in_input.addEventListener( "input" , on_check_in_input_change );
			}
			document.addEventListener( "DOMContentLoaded" , init );
		</script>
	</body>
</html>